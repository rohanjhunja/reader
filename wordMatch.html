<!DOCTYPE html> 
<html> 
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Martel+Sans:wght@300;600;800;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Alegreya:wght@900&display=swap" rel="stylesheet">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<style type="text/css">
	html{
		width:100%; height:100%; overflow: hidden;
	}

	body{
		margin:0;
	    padding:0;
	    width:100%;
	    height: 100%;
	    overflow-x: hidden;
	    overflow-y: hidden;
	    background-color: #e8dcc1;
	    font-family: 'Martel Sans', sans-serif;
	}

	#header{
    width:100%;
    height: 30px;
    background-color: #EE6055; font-family: 'Alegreya', serif; 
    color: white; text-align: center; 
    font-size: 30px;
    line-height: 1.3;
    padding: 10px 0;
  }

  #overview{
    width: 100%;
    background-color: #e8dcc1;
    z-index: 4;  
    position:absolute; top:50px; bottom:0; left:0; right:0; 
  }

  #scroller{
    width: 100%;
    overflow-y: scroll;
    background-color: #e8dcc1;  
    position:absolute; top:10px; bottom:135px; left:0; right:0; 
  }

  #scoreBoard{
  	text-align: center;
  	margin: 10px;
  }


  #list{
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 40px;
    grid-gap: 1rem;
    margin: 0 1rem ;
  }

  .listButton{
    width:100%;
    height:40px;
    border-radius: 10px;
    background-color:   #daceb3;
    overflow: hidden;
    color: white;
    font-size: 20px;
    font-weight: 600;
    text-align: center;
    line-height: 2;
  }


  #controls{
  	position: absolute;
  	bottom: 20px;
  	left:0;
  	right: 0;
  	display: flex;
  	align-items: center;
  	justify-content: center;
  }

  #startMatch{
  	width:50%;
  	height: 30px;
    background-color: #EE6055; font-family: 'Alegreya', serif; 
    color: white; text-align: center; 
    font-size: 30px;
    line-height: 1;
    padding: 10px 0;
    border-radius: 20px;
  }

  #controls2{
  	position: absolute;
  	bottom: 0;
  	width:100%;
  	z-index: 5;
  }

  #takeChallenge, #lesson, #story, #reload{
  	margin: 10px;
  	width:auto;
  	background-color: #938fc5;
  	height: 50px;
  	line-height: 2.5;
  }

  #challenge{
  	text-align: center;
  	margin: 10px;
  }

  #scoreBoard2{
  	position: absolute;
  	top:8px;
  	right:15px;
  	color: yellow;

  }

  #answerList>div{
  	margin: 10px 0;
  }

  #tex{
  	padding: 10px 20px;
  	text-align: center;
  }


  #tex > span{
    display: inline-block;
   }

  #videoFrame{
    background-color: black; overflow-y:hidden; height:170px; position: relative;
  }

  #blank{
  	background-color: #e8dcc1; z-index: 1; position: absolute; bottom:0; height:100%;  width:100%;

  }

  #vidText{
  	 z-index: 2; position: absolute; bottom:0; height:100%;  width:100%;
  	  display: flex;
  justify-content: center;
  align-items: center;
  	 
  }

  .boldText{
  	font-weight: 900;
  	 font-size: 30px;
  		text-shadow:
   -3px -3px 0 #ffffff,  
    3px -3px 0 #ffffff,
    -3px 3px 0 #ffffff,
     3px 3px 0 #ffffff;
  }

  .normalText{
  	font-weight: 600;
  	 font-size: 24px;
  }



	.hide{
		display: none;
	}

</style>

<body>
	<div id=header>Title</div>
	<div id="scoreBoard2" class="normalText"></div>

	<div  id="overview">
		<div id="scoreBoard" class="boldText hide"></div>
		<div id="scroller"><div id="list"></div></div>
		<div id="controls2">
		<div id="story" class="listButton hide" onclick="playStory()">See Story!</div>
		<div id="reload" class="listButton hide" onclick="reload()">Play Again</div>
		<div id="lesson" class="listButton" onclick="Learn()">Learn 3 words</div>
		<div id="takeChallenge" class="listButton" onclick="Challenge()">Start Match</div>
	</div>
	</div>
	

	<div id="videoFrame">
	<video id="vid" width=100% autoplay>
		<source src="zoo.mp4" type="video/mp4">
   		<track kind="subtitles" src="captions.vtt" label="English Reader">
  		Your browser does not support HTML5 video.
	</video>
	<div >
		<div id="blank" class="hide"></div>
		<div id="vidText" class="boldText">
			<div id="word" class="hide"></div>
			<div id="translate" class="hide" onclick="revealWord()"></div>
		</div>
	</div>
	</div>

	<div id="learn">
		<div id="tex" class="normalText hide"></div>
		<div id="controls"><div id="startMatch" class="hide" onclick="startMatch()">Start Match</div><div id="next"></div></div>
	</div>

	<div id="challenge">
		<div id="question" class="normalText"></div>
		<div id="answerList" class="hide"></div>
		<div id="hint" class="hide" onclick="checkTranslate()"></div>
	</div>

</body>

<script type="text/javascript">
	

	var data1 = '[ {"word": "a", "target": "", "": "", "translation": "a", "start": 1, "end": "", "text": ""}, {"word": "by", "target": "", "part": "p", "translation": "करून", "start": 2, "end": "", "text": ""}, {"word": "so", "target": "", "part": "dv", "translation": "त्यामुळे", "start": 2, "end": "", "text": ""}, {"word": "at", "target": "", "part": "p", "translation": "येथे", "start": 2, "end": "", "text": ""}, {"word": "no", "target": "", "": "", "translation": "नाही", "start": 2, "end": "", "text": ""}, {"word": "an", "target": "", "": "", "translation": "an", "start": 2, "end": "", "text": ""}, {"word": "to", "target": "", "": "", "translation": "to", "start": 2, "end": "", "text": ""}, {"word": "we", "target": "", "": "", "translation": "आम्ही", "start": 2, "end": "", "text": ""}, {"word": "go", "target": "", "part": "v", "translation": "जाता जाता", "start": 2, "end": "", "text": ""}, {"word": "did", "target": "", "part": "v", "translation": "केले", "start": 3, "end": "", "text": ""}, {"word": "you", "target": "", "": "", "translation": "आपण", "start": 3, "end": "", "text": ""}, {"word": "see", "target": "", "part": "v", "translation": "पहा", "start": 3, "end": "", "text": ""}, {"word": "the", "target": "", "": "", "translation": "the", "start": 3, "end": "", "text": ""}, {"word": "its", "target": "", "": "", "translation": "त्याच्या", "start": 3, "end": "", "text": ""}, {"word": "way", "target": "", "part": "n", "translation": "मार्ग", "start": 3, "end": "", "text": ""}, {"word": "and", "target": "", "": "", "translation": "and", "start": 3, "end": "", "text": ""}, {"word": "saw", "target": "", "part": "v", "translation": "पाहिले", "start": 3, "end": "", "text": ""}, {"word": "said", "target": "", "part": "v", "translation": "म्हणाला,", "start": 4, "end": "", "text": ""}, {"word": "like", "target": "", "part": "p", "translation": "सारखे", "start": 4, "end": "", "text": ""}, {"word": "this", "target": "", "part": "n", "translation": "this", "start": 4, "end": "", "text": ""}, {"word": "hear", "target": "", "part": "v", "translation": "ऐका", "start": 4, "end": "", "text": ""}, {"word": "must", "target": "", "part": "v", "translation": "हे केलेच पाहिजे", "start": 4, "end": "", "text": ""}, {"word": "have", "target": "", "part": "v", "translation": "आहे", "start": 4, "end": "", "text": ""}, {"word": "seen", "target": "", "part": "v", "translation": "पाहिले", "start": 4, "end": "", "text": ""}, {"word": "that", "target": "", "": "", "translation": "की", "start": 4, "end": "", "text": ""}, {"word": "with", "target": "", "": "", "translation": "सह", "start": 4, "end": "", "text": ""}, {"word": "neck", "target": "", "part": "n", "translation": "मान", "start": 4, "end": "", "text": ""}, {"word": "from", "target": "", "part": "p", "translation": "पासून", "start": 4, "end": "", "text": ""}, {"word": "tree", "target": "", "part": "n", "translation": "झाड", "start": 4, "end": "", "text": ""}, {"word": "went", "target": "", "part": "v", "translation": "गेला", "start": 4, "end": "", "text": ""}, {"word": "story", "target": "", "part": "n", "translation": "कथा", "start": 5, "end": "", "text": ""}, {"word": "nayar", "target": "", "part": "n", "translation": "नायर", "start": 5, "end": "", "text": ""}, {"word": "asked", "target": "", "part": "v", "translation": "विचारले", "start": 5, "end": "", "text": ""}, {"word": "n…n…o", "target": "", "": "", "translation": "n ... n ... ओ", "start": 5, "end": "", "text": ""}, {"word": "today", "target": "", "part": "n", "translation": "आज", "start": 5, "end": "", "text": ""}, {"word": "we’re", "target": "", "": "", "translation": "आम्ही आहोत", "start": 5, "end": "", "text": ""}, {"word": "going", "target": "", "part": "v", "translation": "जाणे", "start": 5, "end": "", "text": ""}, {"word": "amma…", "target": "", "part": "n", "translation": "मीराची आई", "start": 5, "end": "", "text": ""}, {"word": "didn’t", "target": "", "part": "v", "translation": "नाही", "start": 6, "end": "", "text": ""}, {"word": "leaves", "target": "", "part": "n", "translation": "पाने", "start": 6, "end": "", "text": ""}, {"word": "ground", "target": "", "part": "n", "translation": "जमिनीवर", "start": 6, "end": "", "text": ""}, {"word": "nandini", "target": "", "part": "n", "translation": "नंदिनी", "start": 7, "end": "", "text": ""}, {"word": "nothing", "target": "", "part": "n", "translation": "काहीही नाही", "start": 7, "end": "", "text": ""}, {"word": "meera", "target": 2, "part": "n", "translation": "या मुलीचे नाव", "start": "", "end": "", "text": ""}, {"word": "meera’s", "target": "", "part": "n", "translation": "मीरा च्या", "start": 7, "end": "", "text": ""}, {"word": "tomorrow", "target": "", "part": "n", "translation": "उद्या", "start": 8, "end": "", "text": ""}, {"word": "zoo", "target": 1, "part": "n", "translation": "प्राणीसंग्रहालय", "start": "", "end": "", "text": "<span>See</span> <span>the</span> <span>animals</span> <span>at</span> <span>the</span> <span>zoo</span>."}, {"word": "monkeys", "target": 1, "part": "n", "translation": "माकडे", "start": 32, "end": 34, "text": "<span>Meera</span> <span>sees</span> <span>the</span> <span>monkeys</span>."}, {"word": "jump", "target": 1, "part": "v", "translation": "उडी", "start": 27.5, "end": 29.5, "text": "<span>See</span> <span>Amma</span> <span>jump</span>."}, {"word": "lion", "target": 1, "part": "n", "translation": "सिंह", "start": 49, "end": 51, "text": "<span>Meera</span> <span>hears</span> <span>a</span> <span>lion</span>."}, {"word": "roar", "target": 1, "part": "v", "translation": "गर्जना", "start": 43, "end": 47, "text": "<span>Hear</span> <span>Amma</span> <span>roar</span>."}, {"word": "elephant", "target": 1, "part": "n", "translation": "एक हत्ती", "start": 65, "end": 68, "text": "<span>Meera</span> <span>sees</span> <span>the</span> <span>elephant</span>."}, {"word": "swaying", "target": 1, "part": "v", "translation": "डोलत होती", "start": 60, "end": 63, "text": "<span>Amma</span> <span>swaying</span> <span>her</span> <span>hand</span> <span>like</span> <span>an</span> <span>elephant</span>."}, {"word": "trunk", "target": 1, "part": "n", "translation": "ट्रंक", "start": 65, "end": 68, "text": "<span>An</span> <span>elephant</span> <span>has</span> <span>a</span> <span>long</span> <span>trunk</span>."}, {"word": "giraffe", "target": 1, "part": "n", "translation": "एक जिराफ", "start": 78, "end": 80, "text": "<span>Meera</span> <span>sees</span> <span>a</span> <span>giraffe</span>."}, {"word": "long", "target": 1, "part": "dj", "translation": "लांब", "start": 78, "end": "", "text": "<span>A</span> <span>giraffe</span> <span>has</span> <span>a</span> <span>long</span> <span>neck</span>."}, {"word": "eating", "target": 1, "part": "v", "translation": "खाणे", "start": 78, "end": 80, "text": "<span>Meera</span> <span>sees</span> <span>a</span> <span>giraffe</span> <span>eating</span> <span>leaves</span>."}, {"word": "tall", "target": 1, "part": "dj", "translation": "उंच", "start": "", "end": "", "text": "<span>The</span> <span>giraffe</span> <span>eats</span> <span>leaves</span> <span>from</span> <span>a</span> <span>tall</span> <span>tree</span>."}, {"word": "peacock", "target": 1, "part": "n", "translation": "एक मोर", "start": 95, "end": 97, "text": "<span>Meera</span> <span>sees</span> <span>a</span> <span>peacock</span>."}, {"word": "dancing", "target": 1, "part": "v", "translation": "नृत्य", "start": 89, "end": 92, "text": "<span>Amma</span> <span>and</span> <span>Meera</span> <span>are</span> <span>dancing</span>."}, {"word": "crocodile", "target": 1, "part": "n", "translation": "एक मगर", "start": 109, "end": 112, "text": "<span>Meera</span> <span>sees</span> <span>a</span> <span>crocodile</span>."}, {"word": "yawning", "target": 1, "part": "v", "translation": "जांभई", "start": 105, "end": 107, "text": "<span>Amma</span> <span>is</span> <span>yawning</span>."}, {"word": "animals", "target": "", "part": "n", "translation": "प्राणी", "start": "", "end": "", "text": ""}, {"word": "flopped", "target": 1, "part": "v", "translation": "खाली पडणे", "start": 130, "end": 133, "text": "<span>Amma</span> <span>flopped</span> <span>to</span> <span>the</span> <span>ground</span>."}, {"word": "bear", "target": 1, "part": "n", "translation": "एक अस्वल", "start": 134, "end": 136, "text": "<span>Amma</span> <span>and</span> <span>Meera</span> <span>flopped</span> <span>to</span> <span>the</span> <span>ground</span> <span>like</span> <span>a</span> <span>bear</span>."}, {"word": "amma", "target": 2, "part": "n", "translation": "अम्मा", "start": "", "end": "", "text": ""},  {"word": "what", "target": "", "part": "", "translation": "काय", "start": 4, "end": "", "text": ""} ]';

	wordData = JSON.parse(data1);

	var i=-1;
	var starts;
  	var ends;
  	var targets=[];
  	var opened =[];
  	var revise =[];
  	var answered = [];
  	var targetWord;

  	var mMin=3;
  	var mMax=mMin;
  	var turns=0;
  	var m=0;
  	var mode="overview";
  	var hint=false;
  	var score=0;

  	var scoreSound = new sound("ring.mp3");
  	const synth = window.speechSynthesis; 
  	var speakText;
  	

  	document.getElementById("header").innerHTML="At the Zoo";

  	for(b in wordData){
      if(wordData[b].target === 1){
        targets.push(b);
        console.log(b);
        document.getElementById("list").innerHTML+="<div  id=\"word"+(targets.length-1)+"\" class=\"listButton\" onclick=\"controlLearn("+(targets.length-1)+")\">?</div>";
    	}
    }
    shuffle(targets);

    function Learn(){
    	controlLearn(answered.length+revise.length);
    }

    function Challenge(){
    	while(revise.length>0){
    		opened.push(revise.pop());
    		console.log(opened);
    	}
    	while(opened.length<mMax){
    		opened.push(answered.length+opened.length);
    		console.log(opened);
    	}
    	startMatch();
    }

    function controlLearn(x){

    	if(answered.indexOf(x)!==-1 || revise.indexOf(x)!==-1 || x===answered.length+revise.length){
    	console.log(x);
    	i=x;
    	updateMode("learn");
    	nextWord();
    }
    }

    function updateMode(newMode){
    			hide(mode);
    			show(newMode);
    			mode=newMode;
    }

    function nextWord(){
    	document.getElementById("vid").mute=false;
    	console.log("unmute");
    	console.log("opened "+opened.length+" revise "+revise.length+" answered "+answered.length+" mMax "+mMax);
    	if(opened.length+revise.length<mMax && opened.length+revise.length+answered.length<targets.length){
    	hide("blank"); hide("word"); hide("translate"); hide("tex");
    	updateText();
    	updateDisplay();
    }
    else if(opened.length+revise.length===mMax && revise.length>0){
    		i=revise.pop();
    		console.log(i+"revise");
    		hide("blank"); hide("word"); hide("translate"); hide("tex");
    	updateText();
    	updateDisplay();
    	}
    else{
    	hide("next");
  		show("startMatch");
    }
    }



    function updateText(){

    document.getElementById("word"+i).innerHTML=wordData[targets[i]].word;

    document.getElementById("word").innerHTML=wordData[targets[i]].word;
    document.getElementById("translate").innerHTML=wordData[targets[i]].translation;
    document.getElementById("tex").innerHTML=wordData[targets[i]].text;
     $( "span" ).on( "click", giveMeaning);
     if(mode==="challenge"){
     	 document.getElementById("question").innerHTML=wordData[targets[i]].text;
     	 $('span').each(function () {
    		if(wordData[targets[i]].word===(this.innerHTML)){
    			this.style.color = "#daceb3";
    			this.style.backgroundColor = "#daceb3";
    			targetWord=this;
    		}
		});
  }}

  function updateDisplay(){
  	hide("blank");
  	 if(wordData[targets[i]].start !== ""){
  	 	starts = wordData[targets[i]].start;
    	ends = wordData[targets[i]].end;
   		document.getElementById("vid").currentTime=starts;
    	document.getElementById("vid").addEventListener("timeupdate", checkEnd);
    	document.getElementById("vid").play();
    	show("hint");
  	 }
  	 else{
  	 	show("blank");
  	 	hide("hint");
  	 }
  	 checkEnd();
  }

  function checkEnd(){
    if(wordData[targets[i]].end === "" || this.currentTime >= ends){
      document.getElementById("vid").pause();
      this.removeEventListener("timeupdate",checkEnd);
      if(mode==="learn"){
      	if(document.getElementById("tex").className.includes("hide"))
      	show("translate");
 		else{
 			do{
 			i++;
 			console.log("skip "+i);
 		}
 		while(answered.indexOf(i)!==-1);
 			
 			nWord = setTimeout(function(){nextWord();}, 1000);
 		}
      }
      else {
      	show("answerList");
      	speakOut("वाक्य को पूरा करने के लिए सही शब्द चुनें");
      }
    }
  }

  function revealWord(){
  	hide("translate");
  	show("word");
  	scoreSound.play();
  	speakOut("English में कहें. "+wordData[targets[i]].word); 
  	opened.push(i);
  	tSent = setTimeout(function(){hide("word"); show("tex");  speakOut("वाक्य को पढ़ें और शब्द पर टैप करें");}, 3000);
  }

  function giveMeaning(){
  
  const temp = this.innerHTML;

  for(var c in wordData){
    if(wordData[c].word.match(temp.toLowerCase())){
      if(wordData[c].word!==wordData[c].translation)
      		// this.innerHTML+=" ("+wordData[c].translation+")";
      		this.setAttribute("style","color:green;");
      if(wordData[c].word.includes(document.getElementById("word").innerHTML)){
      	document.getElementById("vid").mute=true;
        scoreSound.play();
        speakOut(wordData[targets[i]].text.replace(/<|span|>/g,""));
        speakText.onend = function() {updateDisplay();};
      }
      else{
      	speakOut(wordData[c].word+" मतलब "+wordData[c].translation);
      }
      break;
    }
  }}

  function startMatch(){
  	updateMode("challenge");
  	hide("startMatch");
  	shuffle(opened);
  	console.log(opened);
  	nextMatch();
  }


  function nextMatch(){
  	document.getElementById("vid").mute=false;
  	turns=0;
  	if(opened.length>0){
  		hide("answerList");
  		hide("hint");
  		i=opened.pop();
  		updateText();
  		updateOptions();
  		updateDisplay();
  	}
  	else{
  		mMax=mMax+answered.length-Math.floor((mMax/2));
  		if(mMax<mMin)
  			mMax=mMin;
  		if(mMax>targets.length-answered.length)
  			mMax=targets.length-answered.length;
  		console.log("mMax "+mMax);
  		document.getElementById("scoreBoard").innerHTML=score+"/"+targets.length*10;
  		document.getElementById("lesson").innerHTML="Learn "+mMax+" words!";
  		if(answered.length===targets.length){
  			show("story");
  			show("reload");
  			hide("lesson");
  			hide("takeChallenge");
  		}
  		updateMode("overview");
  	}
  }

  function updateOptions(){
  	var ans =[];
    ans.push(i);
    while(ans.length<4){
     var rIndex = Math.floor(Math.random() * 9);
      if(ans.indexOf(rIndex)===-1)
        ans.push(rIndex);
      console.log(ans.length);
    }
    shuffle(ans);
    console.log(ans);
    document.getElementById("answerList").innerHTML="";
    for (var a in ans){
      document.getElementById("answerList").innerHTML+="<div  id=\"ans"+(ans[a])+"\" class=\"listButton\" onclick=\"checkAnswer("+(ans[a])+")\">"+wordData[targets[ans[a]]].word+"</div>";
    }
  }

  function checkAnswer(answer){
  	if(answer===i){
  		document.getElementById("ans"+answer).style.backgroundColor=getColor(i);
  		targetWord.style.color="green";
      	if(turns===0){
      		updateScore();
      		document.getElementById("word"+answer).style.backgroundColor=getColor(i);
      		answered.push(answer);
      	}
      	else{
      		revise.push(i);
      	}
      	speakOut(wordData[targets[i]].text.replace(/<|span|>/g,""));
      	speakText.onend = function() {scoreSound.play(); document.getElementById("scoreBoard2").innerHTML=score; mNext=setTimeout(function(){nextMatch();}, 1000);};
  	}
  	else {
  		speakOut("नहीं। फिर से कोशिश करें");
  		document.getElementById("ans"+answer).style.backgroundColor='#FF9B85';
  		turns++;
   	}
  }

  function checkTranslate(){
  	show("translate");
  	turns++;
  }

  function updateScore(){
  	score+=10;
  	document.getElementById("scoreBoard").innerHTML=score;
  }

  function playStory(){
  	updateMode("learn");
  	starts = wordData[0].start;
  	document.getElementById("videoFrame").style.height="auto";
   		document.getElementById("vid").currentTime=starts;
    	document.getElementById("vid").addEventListener("ended", function() { document.getElementById("videoFrame").style.height="170px"; updateMode("overview")});
    	document.getElementById("vid").play();

  }

  function reload(){
  	window.location.reload();
  }

  function getColor(e){
  	var col;
  	switch(wordData[targets[e]].part){
  		case 'n':
  		col="#fbc752";
  		break;
  		case 'v':
  		col="#8FB2E4";
  		break;
  		case 'p':
  		col="#FCD99A";
  		break;
  		case 'dj':
  		col="#96DFDB";
  		break;
  		case 'dv':
  		col="#b3acec";
  		break;
  		default: col="#A1D5F8";
  	}
  	console.log(col+" "+wordData[targets[e]].part);
  	return(col);

  }



    function show(a){
    	var str = document.getElementById(a).className;
    	if(str.includes("hide"))
    	document.getElementById(a).className=str.replace("hide","");
    		
    }

    function hide(a){
    	var str = document.getElementById(a).className;
    	if(!str.includes("hide"))
    	document.getElementById(a).className+=" hide";
    }

    function sound(src) {
  this.sound = document.createElement("audio");
  this.sound.src = src;
  this.sound.setAttribute("preload", "auto");
  this.sound.setAttribute("controls", "none");
  this.sound.style.display = "none";
  document.body.appendChild(this.sound);
  this.play = function(){
    this.sound.play();
  }
  this.stop = function(){
    this.sound.pause();
  }
}



async function speakOut (speak){ 
	if(synth.speaking) { 
        console.log('Already speaking....'); 
        if(speak=speakText.text)
        return; 
    }
    if(speak !== '') { 
    	speakText = new SpeechSynthesisUtterance(speak);
    	speakText.lang = 'hi-IN';
    	speakText.rate=0.1;
    	synth.speak(speakText); 
	}
}


function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;
  // While there remain elements to shuffle...
  while (0 !== currentIndex) {
    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }
  return array;
}


</script>
